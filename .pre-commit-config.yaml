# File: .pre-commit-config.yaml
# See https://pre-commit.com for more information
# See https://pre-commit.com/hooks.html for more hooks
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0 # Use a recent version
    hooks:
      - id: check-yaml
      - id: end-of-file-fixer
      - id: trailing-whitespace
      - id: check-added-large-files

  - repo: https://github.com/astral-sh/ruff-pre-commit
    # Ruff version. Must be aligned with the version in pyproject.toml
    rev: v0.4.4 # Choose a specific Ruff version
    hooks:
      # Run the linter. Applies fixes including import sorting, etc.
      - id: ruff
        args: [--fix, --exit-non-zero-on-fix] # Auto-fix and fail if fixes were made
      # Run the formatter. Ensures final code style consistency.
      - id: ruff-format

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.10.0 # Use a recent version of mypy mirror
    hooks:
      - id: mypy
        # Ensure mypy runs with the necessary dependencies installed
        additional_dependencies: [
            "click>=8.0,<9.0",
            "langchain>=0.1.0,<0.3.0",
            "langchain-community>=0.0.20,<0.2.0",
            "langchain-anthropic>=0.1.0,<0.3.0",
            "langchain-openai>=0.1.0,<0.3.0",
            "langchain-google-genai~=0.0.9",
            "pydantic>=2.0,<3.0",
            "types-setuptools"
        ]
        args: [--config-file=pyproject.toml] # Point mypy to the config
        # You might need to adjust entry if your structure changes
        # entry: mypy commitai commitai/tests
